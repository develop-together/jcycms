function viewLayer(e,t,i,a){e||(e=2),0==a.length&&(a={width:"800px",height:"500px"}),layer.open({type:2,title:i.attr("title"),maxmin:!0,shadeClose:!0,area:[a.width,a.height],content:t})}function close_tab(){$(".J_menuTab",parent.document).each(function(e){$(this).hasClass("active")&&($(this).prev("a.J_menuTab").length>0&&$(this).prev("a.J_menuTab").eq(0).addClass("active"),$(this).remove(),parent.$(".J_iframe").eq(e).prev("iframe.J_iframe").length>0&&parent.$(".J_iframe").eq(e).prev("iframe.J_iframe").eq(0).show(),parent.$(".J_iframe").eq(e).remove())})}function EscapeChar(e){return e=e.replace(/\'/g,"\\'"),e=e.replace(/\'/g,"&acute;")}function showPhotos(e,t){if(!jcms._null($(e).attr("data"))){t=t||5;var i=JSON.parse($(e).attr("data"));layer.photos({photos:i,shift:t})}}function reloadImageList(e,t){if(e.parent().attr("class").indexOf("image")>=0){if(!/image\/\w+/.test(t.type))return layer.tips(tips.onlyPictureCanBeSelected,e.parent()),!1;var i=new FileReader;i.readAsDataURL(t);var a=e.attr("multiple");i.onload=function(i){$(e).css("max-width")&&$(e).css("max-width"),$(e).css("max-width")&&$(e).css("max-height");var n='<div class="multi-item col-lg-3 col-sm-3 col-md-3"><img class="upload_image_lists img-thumbnail" src="'+this.result+'"></div>';a?n='<div class="multi-item col-lg-3 col-sm-3 col-md-3"><i class="fa fa-trash cancels" style="position: absolute;right:3px;top: -3px;z-index:999;font-size: 14px;color: red;" data-file="'+t.name+'" data-fid=""></i><img class="upload_image_lists img-thumbnail" src="'+this.result+'"></div>':e.parents("div.image").find("div.multi-img-details").empty(),e.parents("div.image").children("img.none_image").remove(),e.parents("div.image").find("div.multi-img-details").append(n),_clickRemoveImg()}}}function _clickRemoveImg(){$("div.multi-img-details").find("i.cancels").bind("click",function(e){var t=$(this).data("file"),i=$(this).data("fid"),a=$(this).data("input");a=jcms._null(a)?$(this).parent("div").parent("div").parent("div").find("input.feehi_html5_upload").attr("id"):a;var n=$("#del_file_"+a);""!=i&&null!=i&&void 0!=i&&"undefined"!=i&&n.val(n.val()+i+",");var s=$(this).parent().parent(".multi-img-details").prev(".input-append").find("input.filename_lists"),r=($(this).parent().parent(".multi-img-details").parent("div.image").find("input.feehi_html5_upload"),"");if(s&&t){var o=s.val();if(o){for(var l=o.split("、"),c=0;c<l.length;c++)l[c]!=t&&(r+=l[c]+"、");s.val(r.substring(0,r.length-1))}curFiles&&(curFiles=curFiles.filter(function(e){return e.name!==t}))}$(this).parent().remove()})}function showImage(e){articleShowImgTimer=setTimeout(function(){var t=$(e).attr("title");t.length&&layer.tips('<img src="'+t+'" width="100" height="100">',$(e),{tips:[2,"#3595CC"]})},200)}!function(){var e=function(){this.ajax=function(e,t,i,a,n,s,r,o,l){r=r||3e4,s=s||!0,o=o||!1;var c={type:e,url:t,data:i,async:s,timeout:r,dataType:a,success:function(e){n&&"function"==typeof n&&n(e)},error:function(e,t,i){if(l&&"function"==typeof l)l(e,t,i);else{if("timeout"===t)return void swal(tips.error+": timeout!");e.responseJSON&&e.responseJSON.hasOwnProperty("message")&&swal(tips.error+": "+e.responseJSON.message,tips.operatingFailed+".","error")}}};"post"==e.toLowerCase()&&("[object FormData]"===Object.prototype.toString.call(i)||o?(i.append("_csrf_backend",$("meta[name='csrf-token']").attr("content")),c.processData=!1,c.contentType=!1):i._csrf_backend=$("meta[name='csrf-token']").attr("content"));jQuery.ajax(c)},this.callback=function(e,t,i){t=!this._null(t)||"ok",i=!this._null(i)||!1;var a=[{state:"ok",statusCode:200,message:"操作成功"},{state:"error",statusCode:300,message:"操作失败"},{state:"timeout",statusCode:301,message:"操作超时"}],n=200;for(var s in a)t==a[s].state&&(n=a[s].statusCode,e=this._null(e)||a[s].message);var r=200==n?1:2,o=layer.alert(e,{icon:r},function(){i&&200==n&&setTimeout(function(){layer.close(o),layer.closeAll("loading")},1e3)})},this._null=function(e){return""==e||null==e||"undefined"==e||void 0===e},this.datum={},this.autocomplete=function(e,t){if(!t.data&&t.url){-1==t.url.indexOf("?search=%QUERY")&&(-1!=t.url.indexOf("&")?t.url+="&keyword=%QUERY%":t.url+="?keyword=%QUERY%");var i={datumTokenizer:Bloodhound.tokenizers.obj.whitespace(t.displayKey),queryTokenizer:Bloodhound.tokenizers.whitespace};t.isCache?i.prefetch=t.url:i.remote={url:t.url,wildcard:"%QUERY%"},this.datum=new Bloodhound(i)}else this.datum=new Bloodhound({datumTokenizer:function(e){return e[t.displayKey]},queryTokenizer:Bloodhound.tokenizers.whitespace,local:t.data,identify:function(e){return e[t.valueKey]}});this.datum.initialize();jQuery(".typeahead-"+e).typeahead({hint:!0,highlight:!0},{name:t.name,displayKey:t.displayKey,limit:parseInt(t.limit),source:baseUtil.nflTeamsWithDefaults}).on("typeahead:select",function(e,i){$("#"+t.selectedDomId).val(i[t.valueKey])}).on("typeahead:asyncrequest",function(){}).on("typeahead:asynccancel typeahead:asyncreceive",function(e){})},this.nflTeamsWithDefaults=function(e,t,i){this.datum.search(e,t,i)}},t=new e;window.jcms=t}(window),yii.confirm=function(e,t,i){var a=$(this).attr("href"),n=$(this).attr("data-pjax")?$(this).attr("data-pjax"):0,s=$(this).attr("data-method")?$(this).attr("data-method"):"get";a&&"javascript:;"!=a&&"#"!=a||i(),swal({title:e,text:tips.realyToDo,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",cancelButtonText:tips.cancel,confirmButtonText:tips.ok,closeOnConfirm:!1},function(e){e?parseInt(n)?!t||t():(swal(tips.waitingAndNoRefresh,tips.operating+"...","success"),$.ajax({url:a,dataType:"json",type:s,success:function(e){200==e.code?(swal(tips.success+"!",tips.operatingSuccess+".","success"),location.reload()):swal(tips.error+": "+e.message,tips.operatingFailed+".","error")},error:function(e,t,i){swal(tips.error+": "+e.responseJSON.message,tips.operatingFailed+".","error")}})):!i||i()})};var curFiles=[];$(document).ready(function(){$(".multi-operate").click(function(){var e=$(this).attr("href"),t=new Array;return $("tr td input[type=checkbox]:checked").each(function(){t.push($(this).val())}),t.length<=0?(swal(tips.noItemSelected,tips.PleaseSelectOne),!1):(t=t.join(","),swal({title:$(this).attr("data-confirm"),text:t,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",cancelButtonText:tips.cancel,confirmButtonText:tips.ok,closeOnConfirm:!1},function(i){if(!i)return!1;swal(tips.waitingAndNoRefresh,tips.operating+"...","success"),$.ajax({url:e,dataType:"json",type:"get",data:{id:t},success:function(e){200==e.code?(swal(tips.success+"!",tips.operatingSuccess+".","success"),location.reload()):swal(tips.error+": "+e.message,tips.operatingFailed+".","error")},error:function(e,t,i){swal(tips.error+": "+e.responseJSON.message,tips.operatingFailed+".","error")}})}),!1)}),$("a.close-link").click(function(){var e=$(this).parents("div.ibox:first");e.hide(),0==e.length&&($(this).parents("div.ibox-title").hide(),$(this).parents("div.ibox-title:first").next().hide()),$(this).parents("div.ibox:first").hide()}),$("a.collapse-link").click(function(){var e=$(this).parents("div.ibox:first").children("div.ibox-content");e.slideToggle(),"fa fa-chevron-up"==$(this).children("i:first").attr("class")?$(this).children("i:first").attr("class","fa fa-chevron-down"):$(this).children("i:first").attr("class","fa fa-chevron-up"),0==e.length&&$(this).parents("div.ibox-title:first").next().slideToggle()}),_clickRemoveImg(),$("a.refresh").click(function(){return location.reload(),!1}),$(".openContab").click(function(){return parent.openConTab($(this)),!1}),$("div.input-append").bind("click",function(e){if(e.preventDefault(),$("img.upload_image_lists")){$("img.upload_image_lists").remove();var t="",i=$(this).parents("div.image").children("div.input-append").children("input[type='text']").val();i&&(t=i+"、"),$(this).parents("div.image").children("div.input-append").children("input[type='text']").val(t.substr(0,t.length-1))}$(this).parent("div").find('input[type="file"]').click()}),$("input.feehi_html5_upload[type=file]").val()&&$("input.feehi_html5_upload[type=file]").val(""),$("input.feehi_html5_upload[type=file]").bind("change",function(){if("undefined"!=typeof FileReader){var e=$(this),t=$(this)[0].files,i="",a=e.attr("multiple"),n=e.parent("div").find("input.filename_lists").val();a&&n&&(i=n+"、");var s=null;if(t){e.parent("div").find("img.none_image").hide(),t&&t.length&&Array.prototype.push.apply(curFiles,t);for(var r in t)"object"==typeof(s=t[r])&&(i+=s.name+"、",reloadImageList(e,s))}else e.parent("div").find("img.none_image").show();e.parents("div.image").children("div.input-append").children("input[type='text']").val(i.substr(0,i.length-1))}}),$("div.photos_list").length&&$("div.photos_list").bind("click",function(){showPhotos(this,3)});var e=$(".pjax-reload");e.length&&(e.on("pjax:beforeSend",function(e,t){}),e.on("pjax:send",function(e,t){layer.load()}),e.on("pjax:complete",function(e,t,i){layer.closeAll("loading"),$("table tr td a.title").bind("mouseover mouseout",function(){showPhotos(this)})})),$(".clear-search").on("click",function(){var e=$(this).closest("form").attr("action");window.location.href=e}),$("button.ajax-form-submit").bind("click",function(){var e=$(this).parent().parent().parent("form")[0],t=new FormData(e),i=e.getAttribute("action");if(curFiles&&curFiles.length){var a=$(e).find("input.feehi_html5_upload");t.delete(a.attr("name"));for(var n=0;n<curFiles.length;n++)t.append(a.attr("name"),curFiles[n])}jcms.ajax("POST",i,t,"JSON",function(e){return 200==e.statusCode?(layer.msg(e.message,{icon:6}),curFiles=[],setTimeout(function(){location.href=e.href},300)):layer.msg(e.message,{icon:5}),!1},!0,1e4,!0,function(e,t,i){200!==e.status&&layer.alert(e.status+"<br>"+e.readyState+"<br>"+t,{icon:5})})});$("table tr td a.title").hover(function(){showImage(this)},function(){clearTimeout(void 0)}),$(".pjax-refresh").bind("click",function(){var e=$(".pagination").find("li.active > a").attr("href");e?$.pjax.reload(".pjax-reload",{url:e}):$.pjax.reload(".pjax-reload")})});