"use strict";function Hashtable(){this._hash=new Object,this.put=function(t,i){return void 0!==t&&(0==this.containsKey(t)&&(this._hash[t]=void 0===i?null:i,!0))},this.remove=function(t){delete this._hash[t]},this.size=function(){var t=0;for(var i in this._hash)t++;return t},this.get=function(t){return this._hash[t]},this.containsKey=function(t){return void 0!==this._hash[t]},this.clear=function(){for(var t in this._hash)delete this._hash[t]}}function AnalyticEmotion(t){if(void 0!==t){var i=t.match(/\[.*?\]/g);if(null!=i&&""!=i)for(var e=0;e<i.length;e++)if(uSinaEmotionsHt.containsKey(i[e])){var o='<img src="'+uSinaEmotionsHt.get(i[e])+'" height="22" width="22" />';t=t.replace(i[e],o)}}return t}var emotions=new Array,categorys=new Array,uSinaEmotionsHt=new Hashtable;$(function(){$.ajax({dataType:"jsonp",url:"https://api.weibo.com/2/emotions.json?source=1362404091",success:function(t){var i=t.data;for(var e in i)""==i[e].category&&(i[e].category="默认"),void 0==emotions[i[e].category]&&(emotions[i[e].category]=new Array,categorys.push(i[e].category)),emotions[i[e].category].push({name:i[e].phrase,icon:i[e].icon}),uSinaEmotionsHt.put(i[e].phrase,i[e].icon)}})}),function(t){t.fn.SinaEmotion=function(i){function e(){var i=arguments[0]?arguments[0]:0;if(!(i<0||i>=categorys.length/5)){t("#emotions .categorys").html(""),s=i;for(var e=5*i;e<5*(i+1)&&e<categorys.length;++e)t("#emotions .categorys").append(t('<a href="javascript:void(0);">'+categorys[e]+"</a>"));t("#emotions .categorys a").click(function(){o(t(this).text())}),t("#emotions .categorys a").each(function(){t(this).text()==n&&t(this).addClass("current")})}}function o(){var e=arguments[0]?arguments[0]:"默认";arguments[1]&&arguments[1];t("#emotions .container").html(""),n=e;for(var o=0;o<emotions[e].length;++o)t("#emotions .container").append(t('<a href="javascript:void(0);" title="'+emotions[e][o].name+'"><img src="'+emotions[e][o].icon+'" alt="'+emotions[e][o].name+'" width="22" height="22" /></a>'));t("#emotions .container a").click(function(){i.insertText(t(this).attr("title")),t("#emotions").remove()}),t("#emotions .categorys a.current").removeClass("current"),t("#emotions .categorys a").each(function(){t(this).text()==e&&t(this).addClass("current")})}var n,s;t(this).click(function(n){n.stopPropagation();var a=i.offset().top+i.height()+15,r=i.offset().left-1;if(t("#emotions .categorys")[0])return t("#emotions").css({top:a,left:r}),void t("#emotions").toggle();t("body").append('<div id="emotions"></div>'),t("#emotions").css({top:a,left:r}),t("#emotions").html("<div>正在加载，请稍候...</div>"),t("#emotions").click(function(t){t.stopPropagation()}),t("#emotions").html('<div style="float:right"><a href="javascript:void(0);" id="prev">&laquo;</a><a href="javascript:void(0);" id="next">&raquo;</a></div><div class="categorys"></div><div class="container"></div>'),t("#emotions #prev").click(function(){e(s-1)}),t("#emotions #next").click(function(){e(s+1)}),e(),o()}),t("body").click(function(){t("#emotions").remove()}),t.fn.insertText=function(t){return this.each(function(){if("INPUT"===this.tagName||"TEXTAREA"===this.tagName)if(document.selection){this.focus();var i=document.selection.createRange();i.text=t,i.collapse(),i.select()}else if(this.selectionStart||"0"==this.selectionStart){var e=this.selectionStart,o=this.selectionEnd;this.value=this.value.substring(0,e)+t+this.value.substring(o,this.value.length),this.selectionStart=this.selectionEnd=e+t.length}else this.value+=t}),this}}}(jQuery);